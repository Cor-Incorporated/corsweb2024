---
import { getCurrentLocale } from '../../utils/i18n';

interface Props {
  headings: Array<{
    depth: number;
    slug: string;
    text: string;
  }>;
}

const { headings } = Astro.props;
const currentLocale = getCurrentLocale(Astro.url);
const tocTitle = currentLocale === 'ja' ? '目次' : 'Table of Contents';

// Filter only h2 and h3 headings for TOC
const tocHeadings = headings.filter(heading => heading.depth >= 2 && heading.depth <= 3);
---

{tocHeadings.length > 0 && (
  <nav class="rounded-lg border border-stone-200 bg-stone-50 p-4 dark:border-stone-700 dark:bg-stone-800" aria-label={tocTitle}>
    <h2 class="mb-3 text-lg font-semibold text-stone-900 dark:text-stone-100">{tocTitle}</h2>
    <ul class="space-y-2 text-sm">
      {tocHeadings.map(heading => (
        <li
          class={heading.depth === 2 ? '' : 'ml-4'}
          style={heading.depth > 3 ? `margin-left: ${(heading.depth - 2) * 1}rem` : ''}
        >
          <a
            href={`#${heading.slug}`}
            class="text-stone-600 transition-colors hover:text-blue-600 dark:text-stone-400 dark:hover:text-blue-400"
          >
            {heading.text}
          </a>
        </li>
      ))}
    </ul>
  </nav>
)}